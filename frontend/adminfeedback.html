<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin - Feedback Dashboard</title>
</head>
<body>
  <h1>Feedback Dashboard</h1>

  <div id="stats"></div>

  <h2>All Feedbacks</h2>
  <div id="feedbacks"></div>

  <script>
    const API_BASE = "http://localhost:4000";

    async function loadStats() {
      const res = await fetch(`${API_BASE}/feedback/stats`);
      const data = await res.json();

      const statsDiv = document.getElementById("stats");
      statsDiv.innerHTML = `
        <p><b>Total Feedbacks:</b> ${data.stats.totalFeedbacks}</p>
        <p><b>Average Rating:</b> ${data.stats.averageRating} ⭐</p>
      `;
    }

    async function loadFeedbacks() {
      const res = await fetch(`${API_BASE}/feedback`);
      const data = await res.json();

      const container = document.getElementById("feedbacks");
      container.innerHTML = "";

      data.data.forEach(fb => {
        const div = document.createElement("div");
        div.style.border = "1px solid black";
        div.style.margin = "10px";
        div.style.padding = "10px";

        div.innerHTML = `
          <h3>${fb.name} (${fb.email})</h3>
          <p>Rating: ${fb.rating} ⭐</p>
          <p>${fb.comment}</p>
          <p><i>${new Date(fb.createdAt).toLocaleString()}</i></p>
        `;
        container.appendChild(div);
      });
    }

    loadStats();
    loadFeedbacks();
  </script>
</body>
</html>
